<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/total.css">
    <link rel="stylesheet" href="css/style00401.css">
    <title>Document</title>
</head>
<body>
    <div class="main">
        <header>
            <div class="wrap">
                <h1>logo</h1>
                <ul class="util">
                    <li>
                        <a href="#">로그인</a>
                    </li>
                    <li>
                        <a href="#">회원가입</a>
                    </li>
                    <li>
                        <a href="#">커뮤니티</a>
                    </li>
                </ul>
                <ul class="gnb">
                    <li>
                        <a href="index00101.html" class="kids">키즈카페</a>
                        <ul class="sub">
                            <li>
                                <a href="index00101.html">공공형 키즈카페</a>
                            </li>
                            <li>
                                <a href="index00102.html">부산시 키즈카페</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="index00201.html">의료</a>
                        <ul class="sub">
                            <li>
                                <a href="index00201.html">의료시설 안내</a>
                            </li>
                            <li>
                                <a href="index00202.html">휴일 지킴이 야국</a>
                            </li>
                        </ul>
                    <li>
                        <a href="index00301.html">국/공립 어린이집</a>
                        <ul class="sub">
                            <li>
                                <a href="index00301.html">국/공립 어린이집이란?</a>
                            </li>
                            <li>
                                <a href="index00302.html">국/공립 어린이집현황</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="index00401.html">축제/행사</a>
                    </li>
                    <li>
                        <a href="index00501.html">아이와 가볼만한곳</a>
                        <ul class="sub">
                            <li>
                                <a href="index00501.html">견학/체험 신청</a>
                            </li>
                            <li>
                                <a href="index00502.html">문화시설</a>
                            </li>
                            <li>
                                <a href="index00503.html">테마여행</a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </header>

        <div class="loginWrap member">
            <div class="login utilLogin">
                <form action="">
                    <input type="text" placeholder="아이디">
                    <input type="text" placeholder="비밀번호">
                    <button>LOGIN</button>
                </form>
                <ul>
                    <li>
                        <a href="#">아이디 찾기</a>
                    </li>
                    <li>
                        <a href="#">비밀번호 찾기</a>
                    </li>
                    <li>
                        <a href="#">회원가입</a>
                    </li>
                </ul>
                <button class="close">X</button>
            </div>
        </div>

        <div class="content">
            <div class="wrap">
                <div class="leftLine">
                    <h3 class="tit">축제/행사</h3>
                    <ul class="leftUl">
                        <li>
                            
                        </li>
                    </ul>
                </div>
                <div class="rightLine">
                    <h3 class="location">
                        <p>홈 > 축제/행사</p> 
                        <div class="search">
                            <select name="gugun" id="gugun" class="gugun">
                                <option value="기장군">기장군</option>
                                <option value="사상구">사상구</option>
                                <option value="수영구">수영구</option>
                                <option value="연제구">연제구</option>
                                <option value="강서구">강서구</option>
                                <option value="금정구">금정구</option>
                                <option value="사하구">사하구</option>
                                <option value="해운대구">해운대구</option>
                                <option value="북구">북구</option>
                                <option value="남구">남구</option>
                                <option value="동래구">동래구</option>
                                <option value="부산진구">부산진구</option>
                                <option value="영도구">영도구</option>
                                <option value="동구">동구</option>
                                <option value="서구">서구</option>
                                <option value="중구">중구</option>                        
                            </select>
                        </div>
                    </h3>

                    <div class="contain">
                    </div>
                </div><!--rightLine-->
            </div><!--wrap-->
        </div>

        <footer>
            <p>Copyright © Lee Jae Hee All rights reserved</p>
        </footer>

        <script src="js/jquery-3.6.1.min.js"></script>
        <script src="js/total.js"></script>
        <script>
        var festival = new XMLHttpRequest();
        var fetivalUrl = 'http://apis.data.go.kr/6260000/FestivalService/getFestivalKr'; /*fetivalUrl*/
        let festivalserviceKey = 'erdojj57tv96GP5fMEvebnNgj4mB502SRMV%2BAj5%2F459z8MOpcA%2FVijKhuwYxuIvS6YMOvYj1L4zEFLSRrRSTGA%3D%3D';
        var festivalqueryParams = '?' + encodeURIComponent('serviceKey') + '='+ festivalserviceKey; /*Service Key*/
        festivalqueryParams += '&' + encodeURIComponent('numOfRows') + '=' + encodeURIComponent('2000'); /**/
        festivalqueryParams += '&' + encodeURIComponent('pageNo') + '=' + encodeURIComponent('1'); /**/
        // festivalqueryParams += '&' + encodeURIComponent('resultType') + '=' + encodeURIComponent('json'); /**/
        // festivalqueryParams += '&' + encodeURIComponent('UC_SEQ') + '=' + encodeURIComponent(''); /**/

        // let fetivalUrl = "http://apis.data.go.kr/6260000/FestivalService/getFestivalKr?serviceKey=" + serviceKey + "&numOfRows=10&pageNo=1"
        festival.open('GET', fetivalUrl + festivalqueryParams);
        festival.onreadystatechange = function () {
            if (this.readyState == 4) {
                let res = this.responseText;
                let resJSON = new DOMParser().parseFromString(res, 'text/xml');
                resJSON = xmlToJson(resJSON);
                let items = resJSON.response.body.items.item
                console.log(items)
                for(let i = 0; i<items.length; i++) {
                    let festTit = items[i].TITLE
                    let festThum = items[i].MAIN_IMG_THUMB
                    let festInfo = items[i].ITEMCNTNTS
                    let festGu = items[i].GUGUN_NM
                    let festHome = items[i].HOMEPAGE_URL
                    $('.contain').append(`
                        <div class = "itemWrap">
                            <div class = "thum">
                                <img src = "${festThum}">
                            </div>
                            <div class = "text scrollable">
                                <h4>
                                    ${festTit}
                                </h4>

                                <p>
                                    ${festGu}
                                    <a href = '${festHome}' class = 'festHome'>
                                        <button>
                                            홈페이지 가기
                                        </button>
                                    </a>
                                </p>
                                <span>
                                    ${festInfo}
                                </span>
                            </div>
                        </div>
                    `)
                }
            }
        };
 

        festival.send('');

        $('.search').on('change',function(){
            $('.itemWrap').remove();
            let a = $('.gugun').val();
            festival.open('GET', fetivalUrl + festivalqueryParams);
            festival.onreadystatechange = function () {
                if (this.readyState == 4) {
                    let res = this.responseText;
                    let resJSON = new DOMParser().parseFromString(res, 'text/xml');
                    resJSON = xmlToJson(resJSON);
                    let items = resJSON.response.body.items.item
                    console.log(items)
                    for(let i = 0; i<items.length; i++) {
                        if(items[i].GUGUN_NM == a){
                            let festTit = items[i].TITLE
                            let festThum = items[i].MAIN_IMG_THUMB
                            let festInfo = items[i].ITEMCNTNTS
                            let festGu = items[i].GUGUN_NM
                            let festHome = items[i].HOMEPAGE_URL
                            $('.contain').append(`
                                <div class = "itemWrap">
                                    <div class = "thum">
                                        <img src = "${festThum}">
                                    </div>
                                    <div class = "text scrollable">
                                        <h4>
                                            ${festTit}
                                        </h4>
                                        <p>
                                            ${festGu}
                                            <a href = '${festHome}' class = 'festHome'>
                                                <button>
                                                    홈페이지 가기
                                                </button>
                                            </a>
                                        </p>
                                        <span>
                                            ${festInfo}
                                        </span>
                                    </div>
                                </div>
                            `)
                        }
                    }
                }
        };
 

        festival.send('');
        })
        </script>
</body>
</html>